import { Component, Inject, Input } from '@angular/core';
import { Router, ActivatedRoute } from '@angular/router';
import { AuthService } from '../../services/auth.service';
import { FormControl } from '@angular/forms';
import { LoginService } from '../../services/login.service';
import { LoginMessage } from '../../models/login.model';
import { CookieService } from 'ngx-cookie-service';
var LoginComponent = /** @class */ (function () {
    function LoginComponent(config, route, router, _authService, loginService, cookieService) {
        this.config = config;
        this.route = route;
        this.router = router;
        this.loginService = loginService;
        this.cookieService = cookieService;
        this.nxId = 'nx-profile-component';
        this.auth = false;
        this.username = new FormControl('');
        this.password = new FormControl('');
        this.isHide = true;
        this.usernamePlaceholder = 'Usuario';
        this.errorMessage = new LoginMessage();
        if (_authService.IsAuth()) {
            this.auth = true;
        }
        this.authService = _authService;
    }
    LoginComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.errorMessage.message = '';
        this.errorMessage.gotError = false;
        this.errMsg = null;
        this.returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/';
        this.title = this.config.applicationTitle || 'Acceso a usuario';
        this.usernameLabel = this.config.usernameLabel || 'Correo';
        this.loginService.errorHndlr().subscribe(function (msg) {
            _this.errorMessage.gotError = msg.gotError;
            _this.errorMessage.message = msg.message;
        });
    };
    LoginComponent.prototype.Authenticate = function () {
        var _this = this;
        this.authService
            .Authenticate(this.username.value, this.password.value, this.config.application)
            .subscribe(function (result) {
            if (result) {
                _this.router.navigateByUrl(_this.returnUrl);
                if (result.token) {
                    var data = JSON.stringify(result);
                    // console.log(data);
                    localStorage.setItem('currentUser', data);
                    _this.cookieService.set('currentUser', data);
                }
            }
        }, function (error) {
            switch (error.status) {
                case 401:
                case 403:
                    _this.errMsg = 'Verifique usuario y password e intente de nuevo.';
                    break;
                case 0:
                case 404:
                    _this.errMsg =
                        'Error en la comunicación con el servidor, favor de intentar mas tarde.';
                    break;
                default:
                    _this.errMsg = 'Ocurrió un error, favor de intentarlo mas tarde';
                    break;
            }
        });
    };
    LoginComponent.prototype.showPassword = function () {
        this.isHide = !this.isHide;
    };
    LoginComponent.decorators = [
        { type: Component, args: [{
                    selector: 'nx-login',
                    template: "\n    <div id=\"{{nxId}}\" class=\"oss-login\">\n      <div class=\"oss-login-wrapper\">\n        <div class=\"oss-login-logo\">\n          <!-- <img src=\"./assets/img/banregio_logo_naranja.png\" width=\"160\"> -->\n          <img src=\"data:image/png;base64,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\"\n          width=\"160\">\n        </div>\n        <div class=\"oss-login-form\">\n          <div class=\"login-header\">\n            <h2>{{title}}</h2>\n          </div>\n          <label>{{usernameLabel}}</label>\n          <input type=\"text\" [formControl]=\"username\" placeholder=\"{{usernamePlaceholder}}\">\n          <label>Contrase\u00F1a</label>\n          <div class=\"login-password\">\n              <input (keyup.enter)=\"Authenticate()\" [type]=\"isHide ? 'password' : 'text'\" [formControl]=\"password\">\n              <span (click)=\"showPassword()\">Mostrar</span>\n          </div>\n          <span class=\"oss-error-message\">{{ errorMessage.message }}</span>\n          <button (click)=\"Authenticate()\" class=\"dark\">Ingresar</button>\n        </div>\n        <div class=\"oss-login-bottom\">\n          <!-- <h5>\u00BFTienes problemas para ingresar?</h5> -->\n        </div>\n      </div>\n    </div>\n  ",
                    styles: ["\n    .form-signin{max-width:330px;padding:15px;margin:0 auto}.form-signin .form-signin-heading,.form-signin .checkbox{margin-bottom:10px}.form-signin .checkbox{font-weight:400}.form-signin .form-control{position:relative;box-sizing:border-box;height:auto;padding:10px;font-size:16px}.form-signin .form-control:focus{z-index:2}.form-signin input[type=\"email\"]{margin-bottom:-1px;border-bottom-right-radius:0;border-bottom-left-radius:0}.form-signin input[type=\"password\"]{margin-bottom:10px;border-top-left-radius:0;border-top-right-radius:0}\n  "]
                },] },
    ];
    /** @nocollapse */
    LoginComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: ['config',] },] },
        { type: ActivatedRoute, },
        { type: Router, },
        { type: AuthService, },
        { type: LoginService, },
        { type: CookieService, },
    ]; };
    LoginComponent.propDecorators = {
        'nxId': [{ type: Input },],
    };
    return LoginComponent;
}());
export { LoginComponent };
//# sourceMappingURL=login.component.js.map